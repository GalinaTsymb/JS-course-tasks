!function a(n,s,o){function c(r,t){if(!s[r]){if(!n[r]){var e="function"==typeof require&&require;if(!t&&e)return e(r,!0);if(u)return u(r,!0);throw new Error("Cannot find module '"+r+"'")}e=s[r]={exports:{}};n[r][0].call(e.exports,function(t){var e=n[r][1][t];return c(e||t)},e,e.exports,a,n,s,o)}return s[r].exports}for(var u="function"==typeof require&&require,t=0;t<o.length;t++)c(o[t]);return c}({1:[function(t,e,r){"use strict";var a=t("@babel/runtime/helpers/interopRequireDefault")(t("./modules/shop.js")),n=document.querySelector(".js-product-list"),s=document.querySelector(".js-cart-list");document.addEventListener("DOMContentLoaded",function(){new a.default("http://my-json-server.typicode.com/achubirka/db/products",n,s).init()})},{"./modules/shop.js":6,"@babel/runtime/helpers/interopRequireDefault":10}],2:[function(t,e,r){"use strict";var a=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(t("@babel/runtime/helpers/classCallCheck")),s=a(t("@babel/runtime/helpers/createClass")),o=a(t("@babel/runtime/helpers/defineProperty")),c=(t("./localStorage"),t("./helpers"));function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,e=function(){};return{s:e,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){o=!0,n=t},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw n}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function l(e,t){var r,a=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)),a}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,o.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}r.default=function(){function r(t,e){(0,n.default)(this,r),(0,o.default)(this,"keyCartLS","productsInCart"),(0,o.default)(this,"cartItems",{}),(0,o.default)(this,"products_obj",{}),this.selector_cart=t,this.products=e,this.init()}return(0,s.default)(r,[{key:"addProduct",value:function(t){this.plusProduct(t)}},{key:"plusProduct",value:function(t){this.updateObject();var e=this.products_obj[t];(0,c.isEmptyObject)(this.cartItems)?(this.cartItems=(0,o.default)({},e.id,this.products_obj[t]),this.cartItems[t].available--,this.cartItems[t].availableInCart++):0<this.products_obj[t].available&&(null==this.cartItems[t]&&(this.cartItems=d(d({},this.cartItems),{},(0,o.default)({},e.id,this.products_obj[t]))),this.cartItems[t].available--,this.cartItems[t].availableInCart++),this.setProductsLS(),this.counterCart(),this.totalSum()}},{key:"minusProduct",value:function(t){this.updateObject(),(0,c.isEmptyObject)(this.cartItems)||(0<this.products_obj[t].availableInCart&&(this.cartItems[t].available++,this.cartItems[t].availableInCart--),0===this.products_obj[t].availableInCart&&delete this.cartItems[t]),this.setProductsLS(),this.counterCart(),this.totalSum()}},{key:"getProductCount",value:function(t){return this.cartItems[t]?this.cartItems[t].availableInCart:0}},{key:"getProduct",value:function(t){return this.cartItems[t]||0}},{key:"renderCart",value:function(){this.selector_cart.innerHTML=Object.values(this.cartItems).map(function(t){var e=t.available<=0?"disabled":"";return'\n                <li class="cart__item">\n                                    <div>\n                                        <p class="cart__item-name js-products-name">'.concat(t.name,'</p>\n                                        <div class="cart__item-counter-wrap" >\n                                            <button class="cart__item-minus js-btn-minus" data-id="').concat(t.id,'" data-action="minus">-</button>\n                                            <span class="cart__item-counter js-counter">').concat(t.availableInCart,'</span>\n                                            <button class="cart__item-plus js-btn-plus" ').concat(e,' data-id="').concat(t.id,'" data-action="plus">+</button>                                        \n                                        </div>\n                                    </div>\n                                    <div class="cart__item-sum-wrap">\n                                        <span class="cart__item-sum js-sum">$ ').concat((t.availableInCart*t.price).toFixed(2),"</span>\n                                    </div>                                        \n                                </li>\n            ")}).join("")}},{key:"setProductsLS",value:function(){localStorage.setItem(this.keyCartLS,JSON.stringify(this.cartItems)),this.renderCart(),this.selector_cart.dispatchEvent(new Event("cart_update"))}},{key:"getProductsLS",value:function(){this.cartItems=localStorage.getItem(this.keyCartLS),this.cartItems=JSON.parse(this.cartItems)||{}}},{key:"updateObject",value:function(){this.products=(0,c.updateBalances)(this.products,this.cartItems);var t,e=u(this.products);try{for(e.s();!(t=e.n()).done;){var r=t.value;this.products_obj[r.id]=r}}catch(t){e.e(t)}finally{e.f()}}},{key:"counterCart",value:function(){var t=Object.values(this.cartItems).reduce(function(t,e){return t+e.availableInCart},0);localStorage.setItem("cartNumbers",t),document.querySelector(".js-counter-cart").textContent=t}},{key:"totalSum",value:function(){var t=Object.values(this.cartItems).reduce(function(t,e){return t+e.availableInCart*e.price},0);localStorage.setItem("totalSum",t.toFixed(2)),document.querySelector(".js-total-sum").textContent=t.toFixed(2)}},{key:"eventProcess",value:function(){var r=this;this.selector_cart&&this.selector_cart.addEventListener("click",function(t){var e=t.target.dataset;switch(e.action){case"plus":r.plusProduct(e.id);break;case"minus":r.minusProduct(e.id)}})}},{key:"init",value:function(){this.getProductsLS();var t,e=u(this.products);try{for(e.s();!(t=e.n()).done;){var r=t.value;this.products_obj[r.id]=r}}catch(t){e.e(t)}finally{e.f()}this.counterCart(),this.totalSum(),this.eventProcess(),this.renderCart()}},{key:"on",value:function(t,e){this.selector_cart.addEventListener(t,e)}}]),r}()},{"./helpers":3,"./localStorage":4,"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/defineProperty":9,"@babel/runtime/helpers/interopRequireDefault":10}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.status=function(t){return 200===t.status?Promise.resolve(t):Promise.reject(new Error(t.statusText))},r.json=function(t){return t.json()},r.isEmptyObject=function(t){return 0===Object.keys(t).length},r.updateBalances=function(t,r){return t.map(function(t){var e=r[t.id];return e||t})}},{}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getProductsLS=function(t){t=localStorage.getItem(t);return t=JSON.parse(t)||{}},r.setProductsLS=function(t,e){localStorage.setItem("productsInCart",JSON.stringify(e))},r.quantityInCartLS=function(t){t=localStorage.getItem(t);return t=parseInt(t)},r.setQuantityLS=function(t,e){localStorage.setItem(t,e)}},{}],5:[function(t,e,r){"use strict";var a=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(t("@babel/runtime/helpers/classCallCheck")),s=a(t("@babel/runtime/helpers/createClass")),o=t("./helpers");r.default=function(){function a(t,e,r){(0,n.default)(this,a),this.selector_products=t,this.products=e,this.cart=r,this.init()}return(0,s.default)(a,[{key:"addProducts",value:function(t){this.cart.addProduct(t),this.renderProducts()}},{key:"eventProcess",value:function(){var e=this;this.selector_products&&this.selector_products.addEventListener("click",function(){var t=event.target;"add"===t.dataset.action&&e.addProducts(t.dataset.id)}),this.cart.on("cart_update",this.renderProducts.bind(this))}},{key:"updateProducts",value:function(){this.products=(0,o.updateBalances)(this.products,this.cart.cartItems)}},{key:"renderProducts",value:function(){this.updateProducts();var t=this.products.map(function(t){var e=t.available<=0?"disabled ":"";return'<li class="shop-products__item">\n                       <p class="shop-products__name js-products-name">'.concat(t.name,'</p>\n                       <p class="shop-products__price">$<span class="js-products-price"> ').concat(t.price.toFixed(2),'</span></p>\n                       <button type="button" data-action="add"  data-id="').concat(t.id,'" class="btn-add shop-products__btn-add js-add-btn" ').concat(e,">add</button>\n                </li>")}).join("");this.selector_products.innerHTML=t}},{key:"init",value:function(){this.renderProducts(),this.eventProcess()}}]),a}()},{"./helpers":3,"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/interopRequireDefault":10}],6:[function(t,e,r){"use strict";var a=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(t("@babel/runtime/helpers/classCallCheck")),s=a(t("@babel/runtime/helpers/createClass")),o=a(t("@babel/runtime/helpers/defineProperty")),c=a(t("./products.js")),u=a(t("./cart.js")),i=t("./helpers"),l=t("./localStorage");function d(e,t){var r,a=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)),a}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,o.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}r.default=function(){function a(t,e,r){(0,n.default)(this,a),(0,o.default)(this,"products",[]),(0,o.default)(this,"cart",void 0),(0,o.default)(this,"products_list",void 0),(0,o.default)(this,"old_cart",(0,l.getProductsLS)("productsInCart")),this.link=t,this.selector_products=e,this.selector_cart=r}return(0,s.default)(a,[{key:"loadProductsList",value:function(){return fetch(this.link).then(i.status).then(i.json)}},{key:"updateStorage",value:function(){var e=this;window.addEventListener("storage",function(t){e.cart.getProductsLS(),e.cart.renderCart(),e.products_list.renderProducts(),e.products_list.updateProducts(),e.cart.updateObject(),e.cart.counterCart(),e.cart.totalSum()})}},{key:"init",value:function(){var a=this;this.loadProductsList().then(function(t){for(var e=[],r=0;r<t.length;r++)e.push(p(p({},t[r]),{},{availableInCart:0}));a.products=(0,i.updateBalances)(e,a.old_cart),a.cart=new u.default(a.selector_cart,a.products),a.products_list=new c.default(a.selector_products,a.products,a.cart),a.updateStorage()}).catch(function(t){return t})}}]),a}()},{"./cart.js":2,"./helpers":3,"./localStorage":4,"./products.js":5,"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/defineProperty":9,"@babel/runtime/helpers/interopRequireDefault":10}],7:[function(t,e,r){e.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},{}],8:[function(t,e,r){function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}e.exports=function(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t},e.exports.default=e.exports,e.exports.__esModule=!0},{}],9:[function(t,e,r){e.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},e.exports.default=e.exports,e.exports.__esModule=!0},{}],10:[function(t,e,r){e.exports=function(t){return t&&t.__esModule?t:{default:t}},e.exports.default=e.exports,e.exports.__esModule=!0},{}]},{},[1]);